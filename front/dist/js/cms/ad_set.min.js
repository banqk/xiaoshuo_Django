function AdSet(){}AdSet.prototype.initModal=function(){myajax.get({url:"/cms/get_ads/",success:function(t){if(200===t.code){for(var a=t.data.ads,n=[0,0,0,0],i=0;i<a.length;i++){var e=template("adhtml",{ad:a[i]}),o=a[i].location;n[o-1]=1,$("[data-location='"+o+"']").append(e)}for(var l=0;l<4;l++)if(0===n[l]){var d=template("adhtml",{ad:{location:l+1,image_url:"/static/images/novel/advertisement/blank.png",link_to:"",hint:"",id:0}});$("[data-location='"+(l+1)+"']").append(d)}}}})},AdSet.prototype.listenChangeImageEvent=function(){var t=$(".thumbnail-btn");console.log(t),t.click(function(){var n=$(this).children("img"),t=$(this).parents(".modal-body").find(".image-file");t.change(function(){var t=$(this)[0].files[0],a=new FormData;a.append("file",t),myajax.post({url:"/cms/upload_file/",data:a,processData:!1,contentType:!1,success:function(t){if(200===t.code){var a=t.data.url;n.attr("src",a)}}})}),t.trigger("click")})},AdSet.prototype.listenAddSubmitEvent=function(){$(".submit-btn").click(function(){var n=$(this),t=$(this).attr("data-location"),a=$(this).parents(".modal-content"),i=a.find(".thumbnail-btn").children("img").attr("src"),e=a.find('input[name="link_to"]').val(),o=a.find('input[name="hint"]').val(),l=$(this).attr("data-ad-id"),d=null,c=null;c="0"===l?(d="/cms/ad_add/","添加成功"):(d="/cms/ad_edit/","编辑成功");var s={image_url:i,link_to:e,hint:o,location:t};"0"!==l&&(s.id=l),myajax.post({url:d,data:s,success:function(t){if(200===t.code){var a=t.data.ad;window.messageBox.showSuccess(c),n.parents("div.thumbnail").find("img.thumbnail").attr("src",a.image_url),n.parents("div.thumbnail").find(".thumbnail-btn").children("img").attr("src",a.image_url),console.log(n.parents("div.thumbnail")),n.siblings(".close-btn").trigger("click")}}})})},AdSet.prototype.run=function(){var t=this;t.initModal(),setTimeout(function(){t.listenChangeImageEvent(),t.listenAddSubmitEvent()},5e3)},$(function(){(new AdSet).run()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNtcy9hZF9zZXQuanMiXSwibmFtZXMiOlsiQWRTZXQiLCJwcm90b3R5cGUiLCJpbml0TW9kYWwiLCJteWFqYXgiLCJnZXQiLCJ1cmwiLCJzdWNjZXNzIiwicmVzdWx0IiwiYWRzIiwiYXJyIiwiaSIsImxlbmd0aCIsImh0bWwiLCJ0ZW1wbGF0ZSIsImFkIiwibG9jYXRpb24iLCIkIiwiYXBwZW5kIiwibSIsImJIdG1sIiwiaW1hZ2VfdXJsIiwibGlua190byIsImhpbnQiLCJpZCIsImxpc3RlbkNoYW5nZUltYWdlRXZlbnQiLCJ0aHVtYm5haWxCdG4iLCJjb25zb2xlIiwibG9nIiwiY2xpY2siLCJpbWciLCJ0aGlzIiwiY2hpbGRyZW4iLCJmaWxlVGFnIiwicGFyZW50cyIsImZpbmQiLCJjaGFuZ2UiLCJmaWxlIiwiZmlsZXMiLCJmb3JtRGF0YSIsIkZvcm1EYXRhIiwicG9zdCIsImRhdGEiLCJwcm9jZXNzRGF0YSIsImNvbnRlbnRUeXBlIiwiYXR0ciIsInRyaWdnZXIiLCJsaXN0ZW5BZGRTdWJtaXRFdmVudCIsInN1Ym1pdEJ0biIsImNvbnRlbnQiLCJ2YWwiLCJtZXNzYWdlIiwid2luZG93IiwibWVzc2FnZUJveCIsInNob3dTdWNjZXNzIiwic2libGluZ3MiLCJydW4iLCJzZWxmIiwic2V0VGltZW91dCJdLCJtYXBwaW5ncyI6IkFBQUEsU0FBU0EsU0FLVEEsTUFBTUMsVUFBVUMsVUFBWSxXQUN4QkMsT0FBT0MsSUFBSSxDQUNQQyxJQUFPLGdCQUNQQyxRQUFXLFNBQVNDLEdBQ2hCLEdBQXNCLE1BQW5CQSxFQUFhLEtBQVUsQ0FJdEIsSUFIQSxJQUFJQyxFQUFNRCxFQUFhLEtBQU8sSUFDMUJFLEVBQU0sQ0FBQyxFQUFFLEVBQUUsRUFBRSxHQUVUQyxFQUFFLEVBQUVBLEVBQUVGLEVBQUlHLE9BQU9ELElBQUksQ0FDekIsSUFBSUUsRUFBT0MsU0FBUyxTQUFTLENBQUNDLEdBQUtOLEVBQUlFLEtBQ25DSyxFQUFXUCxFQUFJRSxHQUFHSyxTQUN0Qk4sRUFBSU0sRUFBUyxHQUFLLEVBQ2xCQyxFQUFFLG1CQUFxQkQsRUFBVyxNQUFNRSxPQUFPTCxHQUduRCxJQUFJLElBQUlNLEVBQUUsRUFBRUEsRUFBRSxFQUFFQSxJQUNaLEdBQWMsSUFBWFQsRUFBSVMsR0FBUyxDQUNaLElBT0lDLEVBQVFOLFNBQVMsU0FBUyxDQUFDQyxHQVBqQixDQUNWQyxTQUFZRyxFQUFJLEVBQ2hCRSxVQUFhLCtDQUNiQyxRQUFXLEdBQ1hDLEtBQVEsR0FDUkMsR0FBSyxLQUdUUCxFQUFFLG9CQUFzQkUsRUFBRSxHQUFLLE1BQU1ELE9BQU9FLFNBU3BFbkIsTUFBTUMsVUFBVXVCLHVCQUF5QixXQUNyQyxJQUFJQyxFQUFlVCxFQUFFLGtCQUNyQlUsUUFBUUMsSUFBSUYsR0FDWkEsRUFBYUcsTUFBTSxXQUNmLElBQUlDLEVBQU1iLEVBQUVjLE1BQU1DLFNBQVMsT0FDdkJDLEVBQVVoQixFQUFFYyxNQUFNRyxRQUFRLGVBQWVDLEtBQUssZUFDbERGLEVBQVFHLE9BQU8sV0FDWCxJQUFJQyxFQUFPcEIsRUFBRWMsTUFBTSxHQUFHTyxNQUFNLEdBQ3hCQyxFQUFXLElBQUlDLFNBQ25CRCxFQUFTckIsT0FBTyxPQUFPbUIsR0FDdkJqQyxPQUFPcUMsS0FBSyxDQUNSbkMsSUFBTyxvQkFDUG9DLEtBQVFILEVBQ1JJLGFBQWUsRUFDZkMsYUFBZSxFQUNmckMsUUFBVyxTQUFTQyxHQUNoQixHQUFzQixNQUFuQkEsRUFBYSxLQUFVLENBQ3RCLElBQUlhLEVBQVliLEVBQWEsS0FBTyxJQUNwQ3NCLEVBQUllLEtBQUssTUFBTXhCLFNBSy9CWSxFQUFRYSxRQUFRLFlBS3hCN0MsTUFBTUMsVUFBVTZDLHFCQUF1QixXQUNuQjlCLEVBQUUsZUFDUlksTUFBTSxXQUNaLElBQUltQixFQUFZL0IsRUFBRWMsTUFDZGYsRUFBV0MsRUFBRWMsTUFBTWMsS0FBSyxpQkFDeEJJLEVBQVVoQyxFQUFFYyxNQUFNRyxRQUFRLGtCQUMxQmIsRUFBWTRCLEVBQVFkLEtBQUssa0JBQWtCSCxTQUFTLE9BQU9hLEtBQUssT0FDaEV2QixFQUFVMkIsRUFBUWQsS0FBSyx5QkFBeUJlLE1BQ2hEM0IsRUFBTzBCLEVBQVFkLEtBQUssc0JBQXNCZSxNQUMxQzFCLEVBQUtQLEVBQUVjLE1BQU1jLEtBQUssY0FDbEJ2QyxFQUFNLEtBQ042QyxFQUFVLEtBR1ZBLEVBRk0sTUFBUDNCLEdBQ0NsQixFQUFNLGVBQ0ksU0FFVkEsRUFBTSxnQkFDSSxRQUVkLElBQUlvQyxFQUFPLENBQ1ByQixVQUFhQSxFQUNiQyxRQUFXQSxFQUNYQyxLQUFRQSxFQUNSUCxTQUFZQSxHQUVOLE1BQVBRLElBQ0NrQixFQUFTLEdBQUlsQixHQUVqQnBCLE9BQU9xQyxLQUFLLENBQ1JuQyxJQUFPQSxFQUNQb0MsS0FBUUEsRUFDUm5DLFFBQVcsU0FBU0MsR0FDaEIsR0FBc0IsTUFBbkJBLEVBQWEsS0FBVSxDQUN0QixJQUFJTyxFQUFLUCxFQUFhLEtBQU0sR0FDNUI0QyxPQUFPQyxXQUFXQyxZQUFZSCxHQUM5QkgsRUFBVWQsUUFBUSxpQkFBaUJDLEtBQUssaUJBQWlCVSxLQUFLLE1BQU05QixFQUFHTSxXQUN2RTJCLEVBQVVkLFFBQVEsaUJBQWlCQyxLQUFLLGtCQUFrQkgsU0FBUyxPQUFPYSxLQUFLLE1BQU05QixFQUFHTSxXQUN4Rk0sUUFBUUMsSUFBSW9CLEVBQVVkLFFBQVEsa0JBQzlCYyxFQUFVTyxTQUFTLGNBQWNULFFBQVEsZ0JBTzdEN0MsTUFBTUMsVUFBVXNELElBQU0sV0FDbEIsSUFBSUMsRUFBTzFCLEtBQ1gwQixFQUFLdEQsWUFDTHVELFdBQVcsV0FDUEQsRUFBS2hDLHlCQUNMZ0MsRUFBS1Ysd0JBQ1AsTUFHTjlCLEVBQUUsWUFDYyxJQUFJaEIsT0FDVnVEIiwiZmlsZSI6ImNtcy9hZF9zZXQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gQWRTZXQoKXtcclxuXHJcbn1cclxuXHJcbi8vIOWIneWni+WMluaooeaAgee8lui+keahhlxyXG5BZFNldC5wcm90b3R5cGUuaW5pdE1vZGFsID0gZnVuY3Rpb24oKXtcclxuICAgIG15YWpheC5nZXQoe1xyXG4gICAgICAgICd1cmwnOiAnL2Ntcy9nZXRfYWRzLycsXHJcbiAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbihyZXN1bHQpe1xyXG4gICAgICAgICAgICBpZihyZXN1bHRbJ2NvZGUnXSA9PT0gMjAwKXtcclxuICAgICAgICAgICAgICAgIHZhciBhZHMgPSByZXN1bHRbJ2RhdGEnXVsnYWRzJ107XHJcbiAgICAgICAgICAgICAgICB2YXIgYXJyID0gWzAsMCwwLDBdO1xyXG4gICAgICAgICAgICAgICAgLy8g5bCG5bm/5ZGK5pS+5YWl5bm/5ZGK5qCPXHJcbiAgICAgICAgICAgICAgICBmb3IodmFyIGk9MDtpPGFkcy5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbCA9IHRlbXBsYXRlKCdhZGh0bWwnLHsnYWQnOmFkc1tpXX0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBsb2NhdGlvbiA9IGFkc1tpXS5sb2NhdGlvbjtcclxuICAgICAgICAgICAgICAgICAgICBhcnJbbG9jYXRpb24tMV0gPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgICQoXCJbZGF0YS1sb2NhdGlvbj0nXCIgKyBsb2NhdGlvbiArIFwiJ11cIikuYXBwZW5kKGh0bWwpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8g5bCG5bm/5ZGK5qCP5Li656m655qE6K6+572u5Y2g5L2N56ymXHJcbiAgICAgICAgICAgICAgICBmb3IodmFyIG09MDttPDQ7bSsrKXtcclxuICAgICAgICAgICAgICAgICAgICBpZihhcnJbbV0gPT09IDApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYmxhbmtBZCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdsb2NhdGlvbic6IG0gKyAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2ltYWdlX3VybCc6ICcvc3RhdGljL2ltYWdlcy9ub3ZlbC9hZHZlcnRpc2VtZW50L2JsYW5rLnBuZycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbGlua190byc6ICcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2hpbnQnOiAnJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdpZCc6MFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYkh0bWwgPSB0ZW1wbGF0ZSgnYWRodG1sJyx7J2FkJzpibGFua0FkfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCJbZGF0YS1sb2NhdGlvbj0nXCIgKyAobSsxKSArIFwiJ11cIikuYXBwZW5kKGJIdG1sKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KVxyXG59O1xyXG5cclxuLy8g55uR5ZCs5Zu+54mH5pu05pS55LqL5Lu2XHJcbkFkU2V0LnByb3RvdHlwZS5saXN0ZW5DaGFuZ2VJbWFnZUV2ZW50ID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciB0aHVtYm5haWxCdG4gPSAkKCcudGh1bWJuYWlsLWJ0bicpO1xyXG4gICAgY29uc29sZS5sb2codGh1bWJuYWlsQnRuKVxyXG4gICAgdGh1bWJuYWlsQnRuLmNsaWNrKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdmFyIGltZyA9ICQodGhpcykuY2hpbGRyZW4oJ2ltZycpO1xyXG4gICAgICAgIHZhciBmaWxlVGFnID0gJCh0aGlzKS5wYXJlbnRzKCcubW9kYWwtYm9keScpLmZpbmQoJy5pbWFnZS1maWxlJyk7XHJcbiAgICAgICAgZmlsZVRhZy5jaGFuZ2UoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdmFyIGZpbGUgPSAkKHRoaXMpWzBdLmZpbGVzWzBdO1xyXG4gICAgICAgICAgICB2YXIgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTtcclxuICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlJyxmaWxlKTtcclxuICAgICAgICAgICAgbXlhamF4LnBvc3Qoe1xyXG4gICAgICAgICAgICAgICAgJ3VybCc6ICcvY21zL3VwbG9hZF9maWxlLycsXHJcbiAgICAgICAgICAgICAgICAnZGF0YSc6IGZvcm1EYXRhLFxyXG4gICAgICAgICAgICAgICAgJ3Byb2Nlc3NEYXRhJzogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAnY29udGVudFR5cGUnOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24ocmVzdWx0KXtcclxuICAgICAgICAgICAgICAgICAgICBpZihyZXN1bHRbJ2NvZGUnXSA9PT0gMjAwKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGltYWdlX3VybCA9IHJlc3VsdFsnZGF0YSddWyd1cmwnXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW1nLmF0dHIoJ3NyYycsaW1hZ2VfdXJsKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZmlsZVRhZy50cmlnZ2VyKFwiY2xpY2tcIik7XHJcbiAgICB9KVxyXG59O1xyXG5cclxuLy8g55uR5ZCs5bm/5ZGK5o+Q5Lqk5LqL5Lu2XHJcbkFkU2V0LnByb3RvdHlwZS5saXN0ZW5BZGRTdWJtaXRFdmVudCA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc3VibWl0QnRuID0gJCgnLnN1Ym1pdC1idG4nKTtcclxuICAgIHN1Ym1pdEJ0bi5jbGljayhmdW5jdGlvbigpe1xyXG4gICAgICAgIHZhciBzdWJtaXRCdG4gPSAkKHRoaXMpO1xyXG4gICAgICAgIHZhciBsb2NhdGlvbiA9ICQodGhpcykuYXR0cignZGF0YS1sb2NhdGlvbicpO1xyXG4gICAgICAgIHZhciBjb250ZW50ID0gJCh0aGlzKS5wYXJlbnRzKCcubW9kYWwtY29udGVudCcpO1xyXG4gICAgICAgIHZhciBpbWFnZV91cmwgPSBjb250ZW50LmZpbmQoJy50aHVtYm5haWwtYnRuJykuY2hpbGRyZW4oJ2ltZycpLmF0dHIoJ3NyYycpO1xyXG4gICAgICAgIHZhciBsaW5rX3RvID0gY29udGVudC5maW5kKCdpbnB1dFtuYW1lPVwibGlua190b1wiXScpLnZhbCgpO1xyXG4gICAgICAgIHZhciBoaW50ID0gY29udGVudC5maW5kKCdpbnB1dFtuYW1lPVwiaGludFwiXScpLnZhbCgpO1xyXG4gICAgICAgIHZhciBpZCA9ICQodGhpcykuYXR0cignZGF0YS1hZC1pZCcpO1xyXG4gICAgICAgIHZhciB1cmwgPSBudWxsO1xyXG4gICAgICAgIHZhciBtZXNzYWdlID0gbnVsbDtcclxuICAgICAgICBpZihpZCA9PT0gJzAnKXtcclxuICAgICAgICAgICAgdXJsID0gJy9jbXMvYWRfYWRkLyc7XHJcbiAgICAgICAgICAgIG1lc3NhZ2UgPSAn5re75Yqg5oiQ5YqfJztcclxuICAgICAgICB9IGVsc2V7XHJcbiAgICAgICAgICAgIHVybCA9ICcvY21zL2FkX2VkaXQvJztcclxuICAgICAgICAgICAgbWVzc2FnZSA9ICfnvJbovpHmiJDlip8nO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgJ2ltYWdlX3VybCc6IGltYWdlX3VybCxcclxuICAgICAgICAgICAgJ2xpbmtfdG8nOiBsaW5rX3RvLFxyXG4gICAgICAgICAgICAnaGludCc6IGhpbnQsXHJcbiAgICAgICAgICAgICdsb2NhdGlvbic6IGxvY2F0aW9uLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYoaWQgIT09ICcwJyl7XHJcbiAgICAgICAgICAgIGRhdGFbJ2lkJ10gPSBpZFxyXG4gICAgICAgIH1cclxuICAgICAgICBteWFqYXgucG9zdCh7XHJcbiAgICAgICAgICAgICd1cmwnOiB1cmwsXHJcbiAgICAgICAgICAgICdkYXRhJzogZGF0YSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbihyZXN1bHQpe1xyXG4gICAgICAgICAgICAgICAgaWYocmVzdWx0Wydjb2RlJ10gPT09IDIwMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFkID0gcmVzdWx0WydkYXRhJ11bJ2FkJ107XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MobWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgc3VibWl0QnRuLnBhcmVudHMoJ2Rpdi50aHVtYm5haWwnKS5maW5kKCdpbWcudGh1bWJuYWlsJykuYXR0cignc3JjJyxhZC5pbWFnZV91cmwpO1xyXG4gICAgICAgICAgICAgICAgICAgIHN1Ym1pdEJ0bi5wYXJlbnRzKCdkaXYudGh1bWJuYWlsJykuZmluZCgnLnRodW1ibmFpbC1idG4nKS5jaGlsZHJlbignaW1nJykuYXR0cignc3JjJyxhZC5pbWFnZV91cmwpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHN1Ym1pdEJ0bi5wYXJlbnRzKCdkaXYudGh1bWJuYWlsJykpXHJcbiAgICAgICAgICAgICAgICAgICAgc3VibWl0QnRuLnNpYmxpbmdzKCcuY2xvc2UtYnRuJykudHJpZ2dlcihcImNsaWNrXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH0pO1xyXG59O1xyXG5cclxuQWRTZXQucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLmluaXRNb2RhbCgpO1xyXG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgIHNlbGYubGlzdGVuQ2hhbmdlSW1hZ2VFdmVudCgpO1xyXG4gICAgICAgIHNlbGYubGlzdGVuQWRkU3VibWl0RXZlbnQoKTtcclxuICAgIH0sNTAwMCk7XHJcbn07XHJcblxyXG4kKGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgYWRTZXQgPSBuZXcgQWRTZXQoKTtcclxuICAgIGFkU2V0LnJ1bigpO1xyXG59KTsiXX0=
