function PubNovel(){}PubNovel.prototype.listenUploadFileEvent=function(){$("#thumbnail-btn").change(function(){var e=$(this)[0].files[0],t=new FormData;t.append("file",e),myajax.post({url:"/account/upload_file/",data:t,processData:!1,contentType:!1,success:function(e){if(200===e.code){var t=e.data.url;$("#cover_url-form").val(t)}}})})},PubNovel.prototype.handleFileUploadProgress=function(e){var t=e.total.percent.toFixed(0)+"%";PubNovel.progressGroup.show();var o=PubNovel.progressBar;o.css("width",t),o.text(t)},PubNovel.prototype.handleFileUploadError=function(e){PubNovel.progressGroup.hide(),console.log(result.message)},PubNovel.prototype.handleFileUploadComplete=function(e){PubNovel.progressGroup.hide();var t="http://q0i4557d7.bkt.clouddn.com/"+e.key;$("input[name='thumbnail']").val(t)},PubNovel.prototype.listenQiniuUploadFileEvent=function(){var u=this;$("#thumbnail-btn").change(function(){var a=this.files[0];myajax.get({url:"/cms/qntoken/",success:function(e){if(200===e.code){var t=e.data.token,o=(new Date).getTime()+"."+a.name.split(".")[1],n={fname:o,params:{},mimeType:["image/png","image/jpeg","image/gif","video/mp4"]},i={useCdnDomain:!0,retryCount:6,region:qiniu.region.z1},l=qiniu.upload(a,o,t,n,i),r={next:u.handleFileUploadProgress,error:u.handleFileUploadError,complete:u.handleFileUploadComplete};l.subscribe(r)}}})})},PubNovel.prototype.listenSubmitEvent=function(){$("#submit-btn").click(function(){event.preventDefault();var e=$(this).attr("data-novel-id"),t=$("input[name='name']").val(),o=$("input[name='cover_url']").val(),n=$("select[name='category']").val(),i=$("input[name='price']").val(),l=window.ue.getContent();url="/account/edit_novel/",myajax.post({url:url,data:{name:t,cover_url:o,category:n,profile:l,price:i,novel_id:e},success:function(e){if(200===e.code){xfzalert.alertSuccess("恭喜，小说编辑成功！",function(){window.location="/account/novel_list/"})}else console.log(e)}})})},PubNovel.prototype.initUEditor=function(){window.ue=UE.getEditor("editor",{initialFrameHeight:400,serverUrl:"/ueditor/upload/"})},PubNovel.prototype.listenIsFreeEvent=function(){var e=$("select[name='is_free']"),t=$("input[name='price']");"1"===e.val()&&t.show(),e.change(function(){"0"===$(this).val()?(t.val(0),t.hide()):"1"===$(this).val()&&(t.val(0),t.show())}),t.change(function(){0===$(this).val()&&(e.children().eq(0).prop("selected","selected"),$(this).hide())})},PubNovel.prototype.run=function(){this.listenUploadFileEvent(),this.initUEditor(),this.listenSubmitEvent(),this.listenIsFreeEvent()},$(function(){(new PubNovel).run(),PubNovel.progressGroup=$("#progress-group"),PubNovel.progressBar=$(".progress-bar")});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNtcy9lZGl0X25vdmVsLmpzIl0sIm5hbWVzIjpbIlB1Yk5vdmVsIiwicHJvdG90eXBlIiwibGlzdGVuVXBsb2FkRmlsZUV2ZW50IiwiJCIsImNoYW5nZSIsImZpbGUiLCJ0aGlzIiwiZmlsZXMiLCJmb3JtRGF0YSIsIkZvcm1EYXRhIiwiYXBwZW5kIiwibXlhamF4IiwicG9zdCIsInVybCIsImRhdGEiLCJwcm9jZXNzRGF0YSIsImNvbnRlbnRUeXBlIiwic3VjY2VzcyIsInJlc3VsdCIsInZhbCIsImhhbmRsZUZpbGVVcGxvYWRQcm9ncmVzcyIsInBlcmNlbnRUZXh0IiwidG90YWwiLCJwZXJjZW50IiwidG9GaXhlZCIsInByb2dyZXNzR3JvdXAiLCJzaG93IiwicHJvZ3Jlc3NCYXIiLCJjc3MiLCJ0ZXh0IiwiaGFuZGxlRmlsZVVwbG9hZEVycm9yIiwiZXJyb3IiLCJoaWRlIiwiY29uc29sZSIsImxvZyIsIm1lc3NhZ2UiLCJoYW5kbGVGaWxlVXBsb2FkQ29tcGxldGUiLCJyZXNwb25zZSIsImtleSIsImxpc3RlblFpbml1VXBsb2FkRmlsZUV2ZW50Iiwic2VsZiIsImdldCIsInRva2VuIiwiRGF0ZSIsImdldFRpbWUiLCJuYW1lIiwic3BsaXQiLCJwdXRFeHRyYSIsImZuYW1lIiwicGFyYW1zIiwibWltZVR5cGUiLCJjb25maWciLCJ1c2VDZG5Eb21haW4iLCJyZXRyeUNvdW50IiwicmVnaW9uIiwicWluaXUiLCJ6MSIsIm9ic2VydmFibGUiLCJ1cGxvYWQiLCJvYnNlcnZlciIsIm5leHQiLCJjb21wbGV0ZSIsInN1YnNjcmliZSIsImxpc3RlblN1Ym1pdEV2ZW50IiwiY2xpY2siLCJldmVudCIsInByZXZlbnREZWZhdWx0Iiwibm92ZWxJZCIsImF0dHIiLCJjb3Zlcl91cmwiLCJjYXRlZ29yeSIsInByaWNlIiwicHJvZmlsZSIsIndpbmRvdyIsInVlIiwiZ2V0Q29udGVudCIsIm5vdmVsX2lkIiwieGZ6YWxlcnQiLCJhbGVydFN1Y2Nlc3MiLCJsb2NhdGlvbiIsImluaXRVRWRpdG9yIiwiVUUiLCJnZXRFZGl0b3IiLCJpbml0aWFsRnJhbWVIZWlnaHQiLCJzZXJ2ZXJVcmwiLCJsaXN0ZW5Jc0ZyZWVFdmVudCIsImlzRnJlZUlucHV0IiwicHJpY2VJbnB1dCIsImNoaWxkcmVuIiwiZXEiLCJwcm9wIiwicnVuIl0sIm1hcHBpbmdzIjoiQUFBQSxTQUFTQSxZQUtUQSxTQUFTQyxVQUFVQyxzQkFBd0IsV0FDdkJDLEVBQUUsa0JBQ1JDLE9BQU8sV0FDYixJQUFJQyxFQUFPRixFQUFFRyxNQUFNLEdBQUdDLE1BQU0sR0FDeEJDLEVBQVcsSUFBSUMsU0FDbkJELEVBQVNFLE9BQU8sT0FBT0wsR0FDdkJNLE9BQU9DLEtBQUssQ0FDUkMsSUFBTyx3QkFDUEMsS0FBUU4sRUFDUk8sYUFBZSxFQUNmQyxhQUFlLEVBQ2ZDLFFBQVcsU0FBU0MsR0FDaEIsR0FBc0IsTUFBbkJBLEVBQWEsS0FBVSxDQUN0QixJQUFJTCxFQUFNSyxFQUFhLEtBQU8sSUFDVmYsRUFBRSxtQkFDUmdCLElBQUlOLFVBUXRDYixTQUFTQyxVQUFVbUIseUJBQTJCLFNBQVNGLEdBQ25ELElBRUlHLEVBRlFILEVBQU9JLE1BQ0NDLFFBQ01DLFFBQVEsR0FBSyxJQUNuQnhCLFNBQVN5QixjQUNmQyxPQUNkLElBQUlDLEVBQWMzQixTQUFTMkIsWUFDM0JBLEVBQVlDLElBQUksUUFBUVAsR0FDeEJNLEVBQVlFLEtBQUtSLElBSXJCckIsU0FBU0MsVUFBVTZCLHNCQUF3QixTQUFTQyxHQUM1Qi9CLFNBQVN5QixjQUNmTyxPQUNkQyxRQUFRQyxJQUFJaEIsT0FBT2lCLFVBSXZCbkMsU0FBU0MsVUFBVW1DLHlCQUEyQixTQUFTQyxHQUUvQnJDLFNBQVN5QixjQUNmTyxPQUNkLElBRUluQixFQUZTLG9DQUNFd0IsRUFBU0MsSUFFSG5DLEVBQUUsMkJBQ1JnQixJQUFJTixJQUl2QmIsU0FBU0MsVUFBVXNDLDJCQUE2QixXQUM1QyxJQUFJQyxFQUFPbEMsS0FDVUgsRUFBRSxrQkFDUkMsT0FBTyxXQUVsQixJQUFJQyxFQUFPQyxLQUFLQyxNQUFNLEdBQ3RCSSxPQUFPOEIsSUFBSSxDQUNQNUIsSUFBTyxnQkFDUEksUUFBVyxTQUFTQyxHQUNoQixHQUFzQixNQUFuQkEsRUFBYSxLQUFVLENBRXRCLElBQUl3QixFQUFReEIsRUFBYSxLQUFTLE1BRTlCb0IsR0FBTSxJQUFLSyxNQUFRQyxVQUFZLElBQU12QyxFQUFLd0MsS0FBS0MsTUFBTSxLQUFLLEdBQzFEQyxFQUFXLENBQ1hDLE1BQU9WLEVBQ1BXLE9BQVEsR0FDUkMsU0FBVSxDQUFDLFlBQVksYUFBYSxZQUFZLGNBRWhEQyxFQUFTLENBQ1RDLGNBQWEsRUFDYkMsV0FBWSxFQUNaQyxPQUFRQyxNQUFNRCxPQUFPRSxJQUVyQkMsRUFBYUYsTUFBTUcsT0FBT3JELEVBQUtpQyxFQUFJSSxFQUFNSyxFQUFTSSxHQUNsRFEsRUFBVyxDQUVYQyxLQUFRcEIsRUFBS3BCLHlCQUNiVyxNQUFTUyxFQUFLVixzQkFDZCtCLFNBQVlyQixFQUFLSiwwQkFFckJxQixFQUFXSyxVQUFVSCxVQVF6QzNELFNBQVNDLFVBQVU4RCxrQkFBb0IsV0FDbkI1RCxFQUFFLGVBQ1I2RCxNQUFNLFdBQ1pDLE1BQU1DLGlCQUNOLElBQ0lDLEVBRE1oRSxFQUFFRyxNQUNNOEQsS0FBSyxpQkFDbkJ2QixFQUFPMUMsRUFBRSxzQkFBc0JnQixNQUMvQmtELEVBQVlsRSxFQUFFLDJCQUEyQmdCLE1BQ3pDbUQsRUFBV25FLEVBQUUsMkJBQTJCZ0IsTUFDeENvRCxFQUFRcEUsRUFBRSx1QkFBdUJnQixNQUNqQ3FELEVBQVVDLE9BQU9DLEdBQUdDLGFBQ3hCOUQsSUFBTSx1QkFDTkYsT0FBT0MsS0FBSyxDQUNSQyxJQUFPQSxJQUNQQyxLQUFRLENBQ0orQixLQUFRQSxFQUNSd0IsVUFBYUEsRUFDYkMsU0FBWUEsRUFDWkUsUUFBV0EsRUFDWEQsTUFBU0EsRUFDVEssU0FBWVQsR0FFaEJsRCxRQUFXLFNBQVNDLEdBQ2hCLEdBQXNCLE1BQW5CQSxFQUFhLEtBQVUsQ0FFdEIyRCxTQUFTQyxhQURLLGFBQ2dCLFdBQzFCTCxPQUFPTSxTQUFXLDhCQUd0QjlDLFFBQVFDLElBQUloQixTQVFoQ2xCLFNBQVNDLFVBQVUrRSxZQUFjLFdBQzdCUCxPQUFPQyxHQUFLTyxHQUFHQyxVQUFVLFNBQVMsQ0FDOUJDLG1CQUFzQixJQUN0QkMsVUFBYSxzQkFJckJwRixTQUFTQyxVQUFVb0Ysa0JBQW9CLFdBQ25DLElBQUlDLEVBQWNuRixFQUFFLDBCQUNoQm9GLEVBQWFwRixFQUFFLHVCQUNNLE1BQXRCbUYsRUFBWW5FLE9BQ1hvRSxFQUFXN0QsT0FFZjRELEVBQVlsRixPQUFPLFdBQ00sTUFBbEJELEVBQUVHLE1BQU1hLE9BQ1BvRSxFQUFXcEUsSUFBSSxHQUNmb0UsRUFBV3ZELFFBQ2EsTUFBbEI3QixFQUFFRyxNQUFNYSxRQUNkb0UsRUFBV3BFLElBQUksR0FDZm9FLEVBQVc3RCxVQUduQjZELEVBQVduRixPQUFPLFdBQ08sSUFBbEJELEVBQUVHLE1BQU1hLFFBQ1BtRSxFQUFZRSxXQUFXQyxHQUFHLEdBQUdDLEtBQUssV0FBWSxZQUM5Q3ZGLEVBQUVHLE1BQU0wQixXQUtwQmhDLFNBQVNDLFVBQVUwRixJQUFNLFdBRXJCckYsS0FBS0osd0JBR0xJLEtBQUswRSxjQUNMMUUsS0FBS3lELG9CQUVMekQsS0FBSytFLHFCQUdUbEYsRUFBRSxZQUNpQixJQUFJSCxVQUNWMkYsTUFDVDNGLFNBQVN5QixjQUFnQnRCLEVBQUUsbUJBQzNCSCxTQUFTMkIsWUFBY3hCLEVBQUUiLCJmaWxlIjoiY21zL2VkaXRfbm92ZWwubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gUHViTm92ZWwoKXtcclxuXHJcbn1cclxuXHJcbi8vIOebkeWQrOS4iuS8oOWbvueJh+S6i+S7tlxyXG5QdWJOb3ZlbC5wcm90b3R5cGUubGlzdGVuVXBsb2FkRmlsZUV2ZW50ID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciB1cGxvYWRCdG4gPSAkKCcjdGh1bWJuYWlsLWJ0bicpOyAgICAvLyBpbnB1dFxyXG4gICAgdXBsb2FkQnRuLmNoYW5nZShmdW5jdGlvbigpe1xyXG4gICAgICAgIHZhciBmaWxlID0gJCh0aGlzKVswXS5maWxlc1swXTtcclxuICAgICAgICB2YXIgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTtcclxuICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2ZpbGUnLGZpbGUpO1xyXG4gICAgICAgIG15YWpheC5wb3N0KHtcclxuICAgICAgICAgICAgJ3VybCc6ICcvYWNjb3VudC91cGxvYWRfZmlsZS8nLFxyXG4gICAgICAgICAgICAnZGF0YSc6IGZvcm1EYXRhLFxyXG4gICAgICAgICAgICAncHJvY2Vzc0RhdGEnOiBmYWxzZSxcclxuICAgICAgICAgICAgJ2NvbnRlbnRUeXBlJzogZmFsc2UsXHJcbiAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24ocmVzdWx0KXtcclxuICAgICAgICAgICAgICAgIGlmKHJlc3VsdFsnY29kZSddID09PSAyMDApe1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSByZXN1bHRbJ2RhdGEnXVsndXJsJ107XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvdmVyVXJsSW5wdXQgPSAkKCcjY292ZXJfdXJsLWZvcm0nKTtcclxuICAgICAgICAgICAgICAgICAgICBjb3ZlclVybElucHV0LnZhbCh1cmwpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSlcclxufTtcclxuXHJcbi8vIOWbvueJh+S4iuS8oOi/h+eoi+S4rVxyXG5QdWJOb3ZlbC5wcm90b3R5cGUuaGFuZGxlRmlsZVVwbG9hZFByb2dyZXNzID0gZnVuY3Rpb24ocmVzdWx0KXtcclxuICAgIHZhciB0b3RhbCA9IHJlc3VsdC50b3RhbDtcclxuICAgIHZhciBwZXJjZW50ID0gdG90YWwucGVyY2VudDsgICAgLy8gaW50ICDkuIrkvKDnmb7liIbmr5RcclxuICAgIHZhciBwZXJjZW50VGV4dCA9IHBlcmNlbnQudG9GaXhlZCgwKSArICclJzsgICAgIC8vIOWOu+mZpOWwj+aVsOmDqOWIhlxyXG4gICAgdmFyIHByb2dyZXNzR3JvdXAgPSBQdWJOb3ZlbC5wcm9ncmVzc0dyb3VwO1xyXG4gICAgcHJvZ3Jlc3NHcm91cC5zaG93KCk7XHJcbiAgICB2YXIgcHJvZ3Jlc3NCYXIgPSBQdWJOb3ZlbC5wcm9ncmVzc0JhcjtcclxuICAgIHByb2dyZXNzQmFyLmNzcygnd2lkdGgnLHBlcmNlbnRUZXh0KTtcclxuICAgIHByb2dyZXNzQmFyLnRleHQocGVyY2VudFRleHQpXHJcbn07XHJcblxyXG4vLyDlm77niYfkuIrkvKDplJnor69cclxuUHViTm92ZWwucHJvdG90eXBlLmhhbmRsZUZpbGVVcGxvYWRFcnJvciA9IGZ1bmN0aW9uKGVycm9yKXtcclxuICAgIHZhciBwcm9ncmVzc0dyb3VwID0gUHViTm92ZWwucHJvZ3Jlc3NHcm91cDtcclxuICAgIHByb2dyZXNzR3JvdXAuaGlkZSgpO1xyXG4gICAgY29uc29sZS5sb2cocmVzdWx0Lm1lc3NhZ2UpXHJcbn07XHJcblxyXG4vLyDlm77niYfkuIrkvKDmiJDlip9cclxuUHViTm92ZWwucHJvdG90eXBlLmhhbmRsZUZpbGVVcGxvYWRDb21wbGV0ZSA9IGZ1bmN0aW9uKHJlc3BvbnNlKXtcclxuICAgIC8vIHJlc3BvbnNlOiAgICB7IGhhc2g6IC4uLiAsIGtleTogLi4uIH1cclxuICAgIHZhciBwcm9ncmVzc0dyb3VwID0gUHViTm92ZWwucHJvZ3Jlc3NHcm91cDtcclxuICAgIHByb2dyZXNzR3JvdXAuaGlkZSgpO1xyXG4gICAgdmFyIGRvbWFpbiA9ICdodHRwOi8vcTBpNDU1N2Q3LmJrdC5jbG91ZGRuLmNvbS8nO1xyXG4gICAgdmFyIGZpbGVuYW1lID0gcmVzcG9uc2Uua2V5O1xyXG4gICAgdmFyIHVybCA9IGRvbWFpbiArIGZpbGVuYW1lO1xyXG4gICAgdmFyIHRodW1ibmFpbElucHV0ID0gJChcImlucHV0W25hbWU9J3RodW1ibmFpbCddXCIpO1xyXG4gICAgdGh1bWJuYWlsSW5wdXQudmFsKHVybClcclxufTtcclxuXHJcbi8vIOWwhuWbvueJh+S4iuS8oOWIsOS4g+eJm+S6kVxyXG5QdWJOb3ZlbC5wcm90b3R5cGUubGlzdGVuUWluaXVVcGxvYWRGaWxlRXZlbnQgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIHRodW1ibmFpbElucHV0ID0gJCgnI3RodW1ibmFpbC1idG4nKTtcclxuICAgIHRodW1ibmFpbElucHV0LmNoYW5nZShmdW5jdGlvbigpe1xyXG4gICAgICAgIC8vIOiOt+WPluaWh+S7tlxyXG4gICAgICAgIHZhciBmaWxlID0gdGhpcy5maWxlc1swXTtcclxuICAgICAgICBteWFqYXguZ2V0KHtcclxuICAgICAgICAgICAgJ3VybCc6ICcvY21zL3FudG9rZW4vJyxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbihyZXN1bHQpe1xyXG4gICAgICAgICAgICAgICAgaWYocmVzdWx0Wydjb2RlJ10gPT09IDIwMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6I635Y+WdG9rZW7lgLxcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdG9rZW4gPSByZXN1bHRbJ2RhdGEnXVsndG9rZW4nXTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDorr7nva7mlofku7blkI1cclxuICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKSArICcuJyArIGZpbGUubmFtZS5zcGxpdCgnLicpWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwdXRFeHRyYSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm5hbWU6IGtleSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiB7fSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWltZVR5cGU6IFtcImltYWdlL3BuZ1wiLFwiaW1hZ2UvanBlZ1wiLFwiaW1hZ2UvZ2lmXCIsXCJ2aWRlby9tcDRcIl1cclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjb25maWcgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZUNkbkRvbWFpbjp0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXRyeUNvdW50OiA2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWdpb246IHFpbml1LnJlZ2lvbi56MSwgICAgICAgICAgICAvLyB6MeS7o+ihqOWNjuWMl+WcsOWMulxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9ic2VydmFibGUgPSBxaW5pdS51cGxvYWQoZmlsZSxrZXksdG9rZW4scHV0RXh0cmEsY29uZmlnKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgb2JzZXJ2ZXIgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOS7peS4i+WHveaVsOS4reeahHRoaXPkuI3ku6PooahQdWJOb3ZlbOWvueixoVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnbmV4dCc6IHNlbGYuaGFuZGxlRmlsZVVwbG9hZFByb2dyZXNzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnZXJyb3InOiBzZWxmLmhhbmRsZUZpbGVVcGxvYWRFcnJvcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ2NvbXBsZXRlJzogc2VsZi5oYW5kbGVGaWxlVXBsb2FkQ29tcGxldGVcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmFibGUuc3Vic2NyaWJlKG9ic2VydmVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG4vLyDnvJbovpHlsI/or7RcclxuUHViTm92ZWwucHJvdG90eXBlLmxpc3RlblN1Ym1pdEV2ZW50ID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciBzdWJtaXRCdG4gPSAkKCcjc3VibWl0LWJ0bicpO1xyXG4gICAgc3VibWl0QnRuLmNsaWNrKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsgICAgICAgLy8g6Zi75q2i6buY6K6k5LqL5Lu2XHJcbiAgICAgICAgdmFyIGJ0biA9ICQodGhpcyk7XHJcbiAgICAgICAgdmFyIG5vdmVsSWQgPSBidG4uYXR0cignZGF0YS1ub3ZlbC1pZCcpO1xyXG4gICAgICAgIHZhciBuYW1lID0gJChcImlucHV0W25hbWU9J25hbWUnXVwiKS52YWwoKTtcclxuICAgICAgICB2YXIgY292ZXJfdXJsID0gJChcImlucHV0W25hbWU9J2NvdmVyX3VybCddXCIpLnZhbCgpO1xyXG4gICAgICAgIHZhciBjYXRlZ29yeSA9ICQoXCJzZWxlY3RbbmFtZT0nY2F0ZWdvcnknXVwiKS52YWwoKTtcclxuICAgICAgICB2YXIgcHJpY2UgPSAkKFwiaW5wdXRbbmFtZT0ncHJpY2UnXVwiKS52YWwoKTtcclxuICAgICAgICB2YXIgcHJvZmlsZSA9IHdpbmRvdy51ZS5nZXRDb250ZW50KCk7XHJcbiAgICAgICAgdXJsID0gJy9hY2NvdW50L2VkaXRfbm92ZWwvJztcclxuICAgICAgICBteWFqYXgucG9zdCh7XHJcbiAgICAgICAgICAgICd1cmwnOiB1cmwsXHJcbiAgICAgICAgICAgICdkYXRhJzoge1xyXG4gICAgICAgICAgICAgICAgJ25hbWUnOiBuYW1lLFxyXG4gICAgICAgICAgICAgICAgJ2NvdmVyX3VybCc6IGNvdmVyX3VybCxcclxuICAgICAgICAgICAgICAgICdjYXRlZ29yeSc6IGNhdGVnb3J5LFxyXG4gICAgICAgICAgICAgICAgJ3Byb2ZpbGUnOiBwcm9maWxlLFxyXG4gICAgICAgICAgICAgICAgJ3ByaWNlJzogcHJpY2UsXHJcbiAgICAgICAgICAgICAgICAnbm92ZWxfaWQnOiBub3ZlbElkXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24ocmVzdWx0KXtcclxuICAgICAgICAgICAgICAgIGlmKHJlc3VsdFsnY29kZSddID09PSAyMDApe1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gJ+aBreWWnO+8jOWwj+ivtOe8lui+keaIkOWKn++8gSc7XHJcbiAgICAgICAgICAgICAgICAgICAgeGZ6YWxlcnQuYWxlcnRTdWNjZXNzKG1lc3NhZ2UsZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uID0gJy9hY2NvdW50L25vdmVsX2xpc3QvJztcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfSBlbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG59O1xyXG5cclxuLy8g5Yid5aeL5YyWVUVkaXRvclxyXG5QdWJOb3ZlbC5wcm90b3R5cGUuaW5pdFVFZGl0b3IgPSBmdW5jdGlvbigpe1xyXG4gICAgd2luZG93LnVlID0gVUUuZ2V0RWRpdG9yKFwiZWRpdG9yXCIse1xyXG4gICAgICAgICdpbml0aWFsRnJhbWVIZWlnaHQnOiA0MDAsXHJcbiAgICAgICAgJ3NlcnZlclVybCc6ICcvdWVkaXRvci91cGxvYWQvJyxcclxuICAgIH0pXHJcbn07XHJcblxyXG5QdWJOb3ZlbC5wcm90b3R5cGUubGlzdGVuSXNGcmVlRXZlbnQgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIGlzRnJlZUlucHV0ID0gJChcInNlbGVjdFtuYW1lPSdpc19mcmVlJ11cIik7XHJcbiAgICB2YXIgcHJpY2VJbnB1dCA9ICQoXCJpbnB1dFtuYW1lPSdwcmljZSddXCIpO1xyXG4gICAgaWYoaXNGcmVlSW5wdXQudmFsKCkgPT09ICcxJykge1xyXG4gICAgICAgIHByaWNlSW5wdXQuc2hvdygpO1xyXG4gICAgfVxyXG4gICAgaXNGcmVlSW5wdXQuY2hhbmdlKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgaWYoJCh0aGlzKS52YWwoKSA9PT0gJzAnKSB7XHJcbiAgICAgICAgICAgIHByaWNlSW5wdXQudmFsKDApO1xyXG4gICAgICAgICAgICBwcmljZUlucHV0LmhpZGUoKTtcclxuICAgICAgICB9IGVsc2UgaWYoJCh0aGlzKS52YWwoKSA9PT0gJzEnKSB7XHJcbiAgICAgICAgICAgIHByaWNlSW5wdXQudmFsKDApO1xyXG4gICAgICAgICAgICBwcmljZUlucHV0LnNob3coKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIHByaWNlSW5wdXQuY2hhbmdlKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgaWYoJCh0aGlzKS52YWwoKSA9PT0gMCl7XHJcbiAgICAgICAgICAgIGlzRnJlZUlucHV0LmNoaWxkcmVuKCkuZXEoMCkucHJvcChcInNlbGVjdGVkXCIsICdzZWxlY3RlZCcpO1xyXG4gICAgICAgICAgICAkKHRoaXMpLmhpZGUoKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufTtcclxuXHJcblB1Yk5vdmVsLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbigpe1xyXG4gICAgLy8g57yp55Wl5Zu+5LiK5Lyg5Yiw5pys5ZywXHJcbiAgICB0aGlzLmxpc3RlblVwbG9hZEZpbGVFdmVudCgpO1xyXG4gICAgLy8g57yp55Wl5Zu+5LiK5Lyg5Yiw5LiD54mb5LqRXHJcbiAgICAvLyB0aGlzLmxpc3RlblFpbml1VXBsb2FkRmlsZUV2ZW50KCk7XHJcbiAgICB0aGlzLmluaXRVRWRpdG9yKCk7XHJcbiAgICB0aGlzLmxpc3RlblN1Ym1pdEV2ZW50KCk7XHJcblxyXG4gICAgdGhpcy5saXN0ZW5Jc0ZyZWVFdmVudCgpO1xyXG59O1xyXG5cclxuJChmdW5jdGlvbigpe1xyXG4gICAgdmFyIHB1Yk5vdmVsID0gbmV3IFB1Yk5vdmVsKCk7XHJcbiAgICBwdWJOb3ZlbC5ydW4oKTtcclxuICAgIFB1Yk5vdmVsLnByb2dyZXNzR3JvdXAgPSAkKCcjcHJvZ3Jlc3MtZ3JvdXAnKTtcclxuICAgIFB1Yk5vdmVsLnByb2dyZXNzQmFyID0gJCgnLnByb2dyZXNzLWJhcicpO1xyXG59KTsiXX0=
